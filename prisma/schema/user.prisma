model User {
  id              String     @id @default(cuid())
  fullName        String
  email           String     @unique
  password        String
  phoneNumber     String
  profileImage    String?
  bio             String?
  dateOfBirth     DateTime?
  lastLogin       DateTime   @default(now())
  role            UserRole   @default(STUDENT)
  status          UserStatus @default(ACTIVE)
  isEmailVerified Boolean    @default(false)

  // CR Specific Fields
  isCr                 Boolean   @default(false)
  crApprovedAt         DateTime?
  isCrDetailsSubmitted Boolean   @default(false)

  // Add these missing fields:
  crId          String? // For creator relation
  institutionId String? // For institution relation

  // Relationships
  crRegistrations       CRRegistration[]
  createdStudents       User[]                 @relation("StudentCreator")
  creator               User?                  @relation("StudentCreator", fields: [crId], references: [id])
  institution           Institution?           @relation(fields: [institutionId], references: [id])
  createdTeachers       Teacher[]              @relation("TeacherCreatedBy")
  createdSubjects       Subject[]              @relation("SubjectCreatedBy")
  createdRoutines       Routine[]              @relation("RoutineCreatedBy")
  postedNotices         Notice[]               @relation("NoticePostedBy")
  createdAssessments    Assessment[]           @relation("AssessmentCreatedBy")
  reportedIssues        Issue[]                @relation("IssueStudent")
  resolvedIssues        Issue[]                @relation("IssueResolvedBy")
  notifications         Notification[]         @relation("UserNotification")
  auditLogs             AuditLog[]             @relation("AuditLogUser")
  createdClasses        Class[]                @relation("ClassCreatedBy")
  assessmentSubmissions AssessmentSubmission[] @relation("AssessmentSubmissionStudent")
  batchEnrollments      BatchEnrollment[]      @relation("StudentEnrollments")
  enrollmentAdded       BatchEnrollment[]      @relation("EnrollmentAddedBy")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}
